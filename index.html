<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bahamas Store | Cloud Edition</title>
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;800&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <style>
        :root { --primary: #FFD700; --bg-body: #0d0f12; --bg-card: #16191f; --bg-darker: #08090b; --pix: #32bcad; }
        body { background-color: var(--bg-body); color: white; font-family: 'Montserrat', sans-serif; display: flex; flex-direction: column; min-height: 100vh; }
        
        .navbar { background: var(--bg-card); border-bottom: 2px solid var(--primary); z-index: 1050; }
        .navbar-brand { font-weight: 800; color: var(--primary) !important; letter-spacing: 1px; }

        .category-container { background: var(--bg-darker); padding: 12px 0; border-bottom: 1px solid #222; position: sticky; top: 56px; z-index: 1000; }
        .category-scroll { display: flex; gap: 12px; overflow-x: auto; white-space: nowrap; scrollbar-width: none; }
        .cat-btn { background: #1f232b; color: white; border: 1px solid #333; padding: 8px 24px; border-radius: 50px; cursor: pointer; font-weight: 600; transition: 0.3s; }
        .cat-btn.active { background: var(--primary); color: #000; border-color: var(--primary); }

        main { flex: 1; }

        .prod-card { background: var(--bg-card); border-radius: 15px; border: 1px solid #2d3139; overflow: hidden; transition: 0.3s; height: 100%; display: flex; flex-direction: column; }
        .prod-card:hover { border-color: var(--primary); transform: translateY(-8px); }
        .img-container { width: 100%; height: 170px; overflow: hidden; background: #222; }
        .img-container img { width: 100%; height: 100%; object-fit: cover; }

        /* Termos e Rodap√© */
        footer { background: var(--bg-card); border-top: 1px solid #333; padding: 40px 0 20px 0; margin-top: 50px; }
        .footer-logo { font-weight: 800; color: var(--primary); font-size: 1.5rem; }
        .social-link { color: white; font-size: 1.2rem; margin-right: 15px; transition: 0.3s; }
        .social-link:hover { color: var(--primary); }
        .pix-badge { background: var(--pix); color: #000; padding: 4px 10px; border-radius: 5px; font-weight: 800; font-size: 0.8rem; display: inline-flex; align-items: center; gap: 5px; }

        .cart-btn { position: fixed; bottom: 25px; right: 25px; background: var(--primary); width: 65px; height: 65px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.6rem; cursor: pointer; z-index: 2000; color: #000; box-shadow: 0 8px 20px rgba(0,0,0,0.6); }
        .view { display: none; padding-top: 20px; }
        .view.active { display: block; }

        /* Estilo do Modal de Termos */
        .termos-box { background: #000; border: 1px solid #333; padding: 15px; border-radius: 8px; font-size: 0.9rem; color: #ccc; max-height: 400px; overflow-y: auto; text-align: left; }
    </style>
</head>
<body>

    <nav class="navbar navbar-expand navbar-dark sticky-top shadow">
        <div class="container">
            <a class="navbar-brand" href="#" onclick="showView('store')">BAHAMAS STORE</a>
            <button class="btn btn-sm btn-warning fw-bold px-3" onclick="accessAdmin()"><i class="fas fa-user-shield me-1"></i> PAINEL ADM</button>
        </div>
    </nav>

    <main>
        <div id="view-store" class="view active">
            <div class="category-container shadow-sm">
                <div class="container"><div class="category-scroll" id="cat-list"></div></div>
            </div>
            <div class="container py-4"><div class="row g-4" id="prod-grid"></div></div>
        </div>

        <div id="view-admin" class="view container">
            <h3 class="fw-bold text-warning mb-4"><i class="fas fa-tools me-2"></i>Dashboard Administrativo</h3>
            
            <div class="row">
                <div class="col-md-4">
                    <div class="bg-card p-3 rounded border border-secondary mb-3 shadow">
                        <h5 class="fw-bold mb-3">üìÅ Categorias</h5>
                        <input type="text" id="new-cat-name" class="form-control bg-dark text-white border-secondary mb-2" placeholder="Ex: Armas">
                        <button class="btn btn-warning btn-sm w-100 mb-3" onclick="addCategory()">+ Criar Categoria</button>
                        <div id="adm-cat-list" class="list-group"></div>
                    </div>

                    <div class="bg-card p-3 rounded border border-secondary shadow">
                        <h5 class="fw-bold mb-2">üìú Termos de Uso</h5>
                        <p class="text-secondary small">Regras da loja que o cliente deve aceitar.</p>
                        <textarea id="adm-termos-text" class="form-control bg-dark text-white border-secondary mb-2" rows="6"></textarea>
                        <button class="btn btn-outline-warning btn-sm w-100" onclick="saveTermos()">Atualizar Termos</button>
                    </div>
                </div>

                <div class="col-md-8">
                    <div class="bg-card p-4 rounded border border-secondary mb-3 shadow">
                        <h5 class="fw-bold mb-3">üéÅ Novo Produto</h5>
                        <div class="row">
                            <div class="col-md-6 mb-3"><input type="text" id="p-name" class="form-control bg-dark text-white border-secondary" placeholder="Nome"></div>
                            <div class="col-md-6 mb-3"><input type="number" id="p-price" class="form-control bg-dark text-white border-secondary" placeholder="Pre√ßo (Somente n√∫meros)"></div>
                            <div class="col-md-6 mb-3"><select id="p-cat-select" class="form-select bg-dark text-white border-warning"></select></div>
                            <div class="col-md-6 mb-3"><input type="text" id="p-img" class="form-control bg-dark text-white border-secondary" placeholder="Link da Imagem"></div>
                        </div>
                        <button class="btn btn-warning w-100 fw-bold" onclick="saveProduct()">CADASTRAR ITEM</button>
                    </div>

                    <div class="bg-card p-3 rounded border border-secondary shadow">
                        <h5 class="fw-bold mb-3">üìã Itens Ativos</h5>
                        <div class="table-responsive"><table class="table table-dark align-middle"><tbody id="adm-table-prods"></tbody></table></div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <footer>
        <div class="container">
            <div class="row">
                <div class="col-md-5 mb-4 text-center text-md-start">
                    <span class="footer-logo">BAHAMAS STORE</span>
                    <p class="text-secondary mt-2 small">A maior loja de benef√≠cios para o seu jogo. Atendimento personalizado e entrega garantida.</p>
                    <div class="mt-2"><span class="pix-badge"><i class="fas fa-bolt"></i> Pagamentos via PIX</span></div>
                </div>
                <div class="col-md-4 mb-4 text-center text-md-start">
                    <h6 class="fw-bold text-white mb-3">Informa√ß√µes</h6>
                    <ul class="list-unstyled small">
                        <li class="mb-2"><a href="#" onclick="showTermos()" class="text-decoration-none text-secondary hover-warning"><i class="fas fa-file-contract me-2"></i>Termos de Uso</a></li>
                        <li class="mb-2"><a href="https://discord.gg/uV3XzeWAtb" target="_blank" class="text-decoration-none text-secondary"><i class="fab fa-discord me-2"></i>Suporte Discord</a></li>
                    </ul>
                </div>
                <div class="col-md-3 mb-4 text-center text-md-start">
                    <h6 class="fw-bold text-white mb-3">Redes Sociais</h6>
                    <a href="https://discord.gg/uV3XzeWAtb" class="social-link"><i class="fab fa-discord"></i></a>
                    <a href="#" class="social-link"><i class="fab fa-instagram"></i></a>
                </div>
            </div>
            <hr class="border-secondary mt-4">
            <div class="text-center text-secondary small">&copy; 2026 Bahamas Store - Apenas PIX Aceito.</div>
        </div>
    </footer>

    <div class="cart-btn" onclick="openCart()"><i class="fas fa-shopping-basket"></i><span id="cart-badge" class="badge rounded-pill bg-danger position-absolute top-0 start-100 translate-middle">0</span></div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.1/firebase-app.js";
        import { getDatabase, ref, set, onValue, push, remove } from "https://www.gstatic.com/firebasejs/9.22.1/firebase-database.js";

        const firebaseConfig = {
            apiKey: "AIzaSyCYzx7TPmAghFcGuKYzBDIYRW0SjrMJ_r8",
            authDomain: "quebrei-o-sistema.firebaseapp.com",
            databaseURL: "https://quebrei-o-sistema-default-rtdb.firebaseio.com",
            projectId: "quebrei-o-sistema",
            storageBucket: "quebrei-o-sistema.firebasestorage.app",
            messagingSenderId: "133672006102",
            appId: "1:133672006102:web:e62c681ced44b3650f7477"
        };

        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);
        let storeData = { prods: {}, cats: {}, termos: "Os termos de uso ainda n√£o foram configurados pelo administrador." };
        let cart = [];

        onValue(ref(db, 'store'), (snap) => { 
            storeData = snap.val() || storeData; 
            if(storeData.termos) document.getElementById('adm-termos-text').value = storeData.termos;
            renderStore(); renderAdmin(); 
        });

        window.showView = (v) => { document.querySelectorAll('.view').forEach(e => e.classList.remove('active')); document.getElementById('view-' + v).classList.add('active'); };
        
        window.saveTermos = () => {
            const texto = document.getElementById('adm-termos-text').value;
            set(ref(db, 'store/termos'), texto);
            Swal.fire('Sucesso', 'Termos atualizados!', 'success');
        };

        window.showTermos = () => {
            Swal.fire({
                title: 'Termos de Uso & Condi√ß√µes',
                background: '#16191f', color: '#fff',
                html: `<div class="termos-box">${storeData.termos.replace(/\n/g, '<br>')}</div>`,
                confirmButtonText: 'Entendi'
            });
        };

        window.saveProduct = () => {
            const name = document.getElementById('p-name').value;
            const price = document.getElementById('p-price').value;
            const cat = document.getElementById('p-cat-select').value;
            const img = document.getElementById('p-img').value;
            if(!name || !price || !cat) return Swal.fire('Erro', 'Preencha os campos!', 'error');
            const key = push(ref(db, 'store/prods')).key;
            set(ref(db, `store/prods/${key}`), { id: key, name, price, cat, img });
            Swal.fire('Sucesso', 'Item publicado!', 'success');
        };

        window.addCategory = () => {
            const name = document.getElementById('new-cat-name').value;
            if(!name) return;
            const key = push(ref(db, 'store/cats')).key;
            set(ref(db, `store/cats/${key}`), { id: key, name });
            document.getElementById('new-cat-name').value = '';
        };

        window.renderStore = (filter = 'Todos') => {
            const cats = Object.values(storeData.cats || {});
            document.getElementById('cat-list').innerHTML = `<div class="cat-btn ${filter==='Todos'?'active':''}" onclick="renderStore('Todos')">Todos</div>` + 
                cats.map(c => `<div class="cat-btn ${filter===c.name?'active':''}" onclick="renderStore('${c.name}')">${c.name}</div>`).join('');

            const items = Object.values(storeData.prods || {});
            const filtered = filter === 'Todos' ? items : items.filter(p => p.cat === filter);
            document.getElementById('prod-grid').innerHTML = filtered.map(p => `
                <div class="col-6 col-md-4 col-lg-3">
                    <div class="prod-card">
                        <div class="img-container"><img src="${p.img || 'https://via.placeholder.com/200'}"></div>
                        <div class="p-3">
                            <small class="text-warning fw-bold">${p.cat}</small>
                            <h6 class="fw-bold mb-2 text-truncate">${p.name}</h6>
                            <div class="d-flex justify-content-between align-items-center">
                                <span class="fw-bold">R$ ${p.price}</span>
                                <button class="btn btn-sm btn-warning" onclick="addToCart('${p.id}')">+</button>
                            </div>
                        </div>
                    </div>
                </div>`).join('');
        };

        window.renderAdmin = () => {
            const cats = Object.values(storeData.cats || {});
            document.getElementById('adm-cat-list').innerHTML = cats.map(c => `<div class="list-group-item bg-dark text-white d-flex justify-content-between border-secondary py-1 small">${c.name}<i class="fas fa-trash text-danger" onclick="removeData('cats/${c.id}')" style="cursor:pointer"></i></div>`).join('');
            document.getElementById('p-cat-select').innerHTML = '<option value="">Escolha...</option>' + cats.map(c => `<option value="${c.name}">${c.name}</option>`).join('');
            const prods = Object.values(storeData.prods || {});
            document.getElementById('adm-table-prods').innerHTML = prods.map(p => `<tr><td><small>${p.name}</small></td><td class="text-end text-warning">R$ ${p.price} <i class="fas fa-trash text-danger ms-2" onclick="removeData('prods/${p.id}')" style="cursor:pointer"></i></td></tr>`).join('');
        };

        window.removeData = (path) => remove(ref(db, `store/${path}`));
        window.accessAdmin = () => Swal.fire({title: 'Senha ADM', input: 'password'}).then(r => { if(r.value === '2707') showView('admin') });
        window.addToCart = (id) => { cart.push({...storeData.prods[id], cartId: Date.now()}); document.getElementById('cart-badge').innerText = cart.length; };
        
        window.openCart = () => {
            const total = cart.reduce((s, i) => s + parseFloat(i.price), 0);
            Swal.fire({
                title: 'üõí Carrinho', background: '#16191f', color: '#fff',
                html: `
                    <div class="mb-3">${cart.map(i => `<div class="d-flex justify-content-between border-bottom border-secondary py-1 small"><span>${i.name}</span><b>R$ ${i.price}</b></div>`).join('')}</div>
                    <div class="mt-3 p-2 rounded" style="background: rgba(50, 188, 173, 0.1); border: 1px dashed var(--pix)">
                        <span class="pix-badge"><i class="fas fa-bolt"></i> Pagamento via PIX</span>
                        <p class="small text-secondary mt-1 mb-0">Envie o comprovante ap√≥s o pedido no Discord.</p>
                    </div>
                    <h4 class="mt-3 text-warning">Total: R$ ${total.toFixed(2)}</h4>
                `,
                showCancelButton: true, confirmButtonText: 'Finalizar Pedido', cancelButtonText: 'Limpar', confirmButtonColor: '#32bcad'
            }).then(r => {
                if(r.isConfirmed && cart.length > 0) {
                    navigator.clipboard.writeText(`üõí *PEDIDO BAHAMAS*\n${cart.map(i => `‚Ä¢ ${i.name}`).join('\n')}\nüí∞ *TOTAL:* R$ ${total.toFixed(2)}\nüí† *PAGAMENTO:* PIX`);
                    window.open('https://discord.gg/uV3XzeWAtb', '_blank');
                    cart = []; document.getElementById('cart-badge').innerText = 0;
                } else if(r.dismiss === Swal.DismissReason.cancel) { cart = []; document.getElementById('cart-badge').innerText = 0; }
            });
        };
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
