<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QUEBREI O SISTEMA | Galactic Hub</title>
    
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-database-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-auth-compat.js"></script>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>

    <style>
        :root { 
            --primary: #00ff88; 
            --secondary: #007bff; 
            --bg: #02010a; 
            --glass: rgba(255, 255, 255, 0.05); 
            --danger: #ff4d4d; 
        }

        * { margin: 0; padding: 0; box-sizing: border-box; transition: 0.3s; }

        body { 
            font-family: 'Segoe UI', sans-serif; 
            background: radial-gradient(circle at center, #1a0b2e 0%, #02010a 100%) fixed;
            color: white; min-height: 100vh; overflow-x: hidden;
        }

        /* FUNDO ESPACIAL */
        .stars {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: url('https://www.transparenttextures.com/patterns/stardust.png');
            opacity: 0.3; z-index: -1; animation: moveStars 120s linear infinite;
        }
        @keyframes moveStars { from {background-position: 0 0;} to {background-position: 1000px 1000px;} }

        /* HEADER ESTILO STORE */
        header {
            background: rgba(0,0,0,0.9); backdrop-filter: blur(15px);
            padding: 20px 8%; display: flex; justify-content: space-between;
            align-items: center; border-bottom: 1px solid rgba(255,255,255,0.1);
            position: sticky; top: 0; z-index: 1000;
        }

        .logo { font-size: 1.4rem; letter-spacing: 1px; font-weight: 300; }
        .logo b { font-weight: 900; color: #fff; }
        .logo span { color: var(--secondary); text-shadow: 0 0 10px var(--secondary); }

        nav { display: flex; gap: 25px; align-items: center; }
        nav a { color: #999; text-decoration: none; font-size: 0.85rem; text-transform: uppercase; font-weight: bold; cursor: pointer; }
        nav a:hover, nav a.active { color: #fff; text-shadow: 0 0 10px #fff; }

        /* FILTROS E BANNER */
        .container { max-width: 1250px; margin: 30px auto; padding: 0 5%; }
        
        .filters { display: flex; gap: 10px; margin-bottom: 30px; overflow-x: auto; padding-bottom: 10px; }
        .btn-filter { background: var(--glass); border: 1px solid #333; color: #ccc; padding: 8px 18px; border-radius: 20px; cursor: pointer; white-space: nowrap; }
        .btn-filter.active, .btn-filter:hover { background: var(--secondary); color: white; border-color: var(--secondary); }

        /* CARDS DE PRODUTOS */
        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(260px, 1fr)); gap: 25px; }
        .card { 
            background: var(--glass); border: 1px solid rgba(255,255,255,0.08);
            border-radius: 12px; padding: 25px; text-align: center; backdrop-filter: blur(5px);
        }
        .card:hover { transform: translateY(-8px); border-color: var(--primary); box-shadow: 0 10px 30px rgba(0, 255, 136, 0.1); }
        .card img { width: 100%; height: 180px; object-fit: contain; margin-bottom: 15px; border-radius: 8px; }
        .no-img { height: 180px; display: flex; align-items: center; justify-content: center; font-size: 4rem; opacity: 0.2; }
        
        .cat-tag { font-size: 0.65rem; background: var(--secondary); padding: 3px 10px; border-radius: 5px; text-transform: uppercase; margin-bottom: 10px; display: inline-block; }

        /* BOTÃ•ES */
        .btn { padding: 12px 20px; border-radius: 6px; border: none; font-weight: bold; cursor: pointer; color: white; display: inline-flex; align-items: center; gap: 10px; justify-content: center; }
        .btn-buy { background: var(--secondary); width: 100%; }
        .btn-google { background: #db4437; font-size: 0.75rem; padding: 8px 15px; }

        /* PAINEL ADMIN */
        .admin-box { background: rgba(0,0,0,0.8); padding: 40px; border-radius: 15px; border: 1px solid var(--primary); }
        .form-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 30px; }
        input, select { width: 100%; background: #000; border: 1px solid #333; color: white; padding: 12px; border-radius: 6px; margin: 8px 0; outline: none; }
        input:focus { border-color: var(--primary); }

        /* NOTIFICAÃ‡Ã•ES */
        #notif { position: fixed; bottom: 20px; right: 20px; z-index: 9999; }
        .toast { background: #111; border-left: 5px solid var(--primary); padding: 15px 25px; border-radius: 4px; margin-top: 10px; animation: slideIn 0.3s forwards; }
        @keyframes slideIn { from {transform: translateX(120%);} to {transform: translateX(0);} }

        section { display: none; }
        section.active { display: block; animation: fadeIn 0.5s ease; }
        @keyframes fadeIn { from {opacity: 0;} to {opacity: 1;} }
    </style>
</head>
<body>

<div class="stars"></div>
<div id="notif"></div>

<header>
    <div class="logo" onclick="openTab('loja')">QUEBREI O <span><b>SISTEMA</b></span></div>
    <nav>
        <a onclick="openTab('loja')" id="nav-loja" class="active">RecepÃ§Ã£o</a>
        <a onclick="openTab('forum')" id="nav-forum">Comunidade</a>
        <a onclick="openTab('suporte')" id="nav-suporte">Suporte</a>
        <div id="auth-area">
            <button class="btn btn-google" onclick="login()">
                <i class="fab fa-google"></i> LOGIN GMAIL
            </button>
        </div>
    </nav>
</header>

<div class="container">
    <section id="loja" class="active">
        <div class="filters" id="cat-filters">
            <button class="btn-filter active" onclick="renderStore('all')">Todos</button>
        </div>
        <div id="store-grid" class="grid"></div>
    </section>

    <section id="forum">
        <div style="background: rgba(0,0,0,0.5); border-radius: 12px; border: 1px solid #222; height: 500px; display: flex; flex-direction: column; overflow: hidden;">
            <div id="chat-msgs" style="flex: 1; padding: 20px; overflow-y: auto;"></div>
            <div style="padding: 20px; background: rgba(0,0,0,0.3); display: flex; gap: 10px;">
                <input type="text" id="chat-in" placeholder="Envie uma mensagem...">
                <button class="btn btn-buy" style="width:auto" onclick="sendChat()">ENVIAR</button>
            </div>
        </div>
    </section>

    <section id="admin">
        <div class="admin-box">
            <h2 style="color:var(--primary); margin-bottom: 25px;"><i class="fas fa-user-shield"></i> GestÃ£o do Sistema</h2>
            
            <div class="form-grid">
                <div>
                    <h3>Gerenciar Categorias</h3>
                    <input type="text" id="new-cat-name" placeholder="Nome da Categoria">
                    <button class="btn btn-buy" onclick="addCategory()">CRIAR CATEGORIA</button>
                    <div id="admin-cat-list" style="margin-top: 20px;"></div>
                </div>

                <div>
                    <h3 id="form-title">Adicionar Produto</h3>
                    <input type="hidden" id="edit-id">
                    <input type="text" id="p-name" placeholder="Nome do Produto">
                    <input type="number" id="p-price" placeholder="PreÃ§o (R$)">
                    <input type="text" id="p-img" placeholder="Link da Imagem">
                    <select id="p-cat"></select>
                    <button class="btn btn-buy" id="btn-save" onclick="saveProduct()">CADASTRAR</button>
                    <button class="btn" id="btn-cancel" style="display:none; background:#444; margin-top:5px; width:100%" onclick="resetForm()">CANCELAR EDIÃ‡ÃƒO</button>
                </div>
            </div>

            <hr style="margin: 40px 0; border: 0; border-top: 1px solid #222;">
            
            <h3>Itens Cadastrados</h3>
            <div id="admin-items-grid" class="grid" style="margin-top: 20px;"></div>
        </div>
    </section>
</div>

<footer style="padding:60px; text-align:center; opacity:0.1; cursor:pointer" onclick="accessAdmin()">ADMIN</footer>

<script>
    // CONFIGURAÃ‡ÃƒO FIREBASE
    const firebaseConfig = {
        apiKey: "AIzaSyCYzx7TPmAghFcGuKYzBDIYRW0SjrMJ_r8",
        authDomain: "quebrei-o-sistema.firebaseapp.com",
        databaseURL: "https://quebrei-o-sistema-default-rtdb.firebaseio.com",
        projectId: "quebrei-o-sistema",
        appId: "1:133672006102:web:e62c681ced44b3650f7477"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();
    const auth = firebase.auth();
    let user = null;

    function toast(m) {
        const t = document.createElement('div'); t.className = 'toast'; t.innerText = m;
        document.getElementById('notif').appendChild(t);
        setTimeout(() => t.remove(), 3000);
    }

    function openTab(id) {
        document.querySelectorAll('section').forEach(s => s.classList.remove('active'));
        document.querySelectorAll('nav a').forEach(a => a.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        if(id !== 'admin') document.getElementById('nav-'+id).classList.add('active');
    }

    function login() {
        const provider = new firebase.auth.GoogleAuthProvider();
        auth.signInWithPopup(provider).then(res => {
            user = res.user;
            document.getElementById('auth-area').innerHTML = `<img src="${user.photoURL}" style="width:35px; border-radius:50%; border:2px solid var(--primary)">`;
            toast("Logado como " + user.displayName);
        }).catch(() => toast("Erro no Login!"));
    }

    // --- LÃ“GICA DE CATEGORIAS ---
    function addCategory() {
        const name = document.getElementById('new-cat-name').value;
        if(name) {
            db.ref('categorias').push({ name });
            document.getElementById('new-cat-name').value = "";
            toast("Categoria Adicionada!");
        }
    }

    db.ref('categorias').on('value', snap => {
        const filters = document.getElementById('cat-filters');
        const select = document.getElementById('p-cat');
        const adminList = document.getElementById('admin-cat-list');
        
        filters.innerHTML = '<button class="btn-filter active" onclick="renderStore(\'all\')">Todos</button>';
        select.innerHTML = '<option value="">Sem Categoria</option>';
        adminList.innerHTML = "";

        snap.forEach(child => {
            const cat = child.val();
            filters.innerHTML += `<button class="btn-filter" onclick="renderStore('${cat.name}')">${cat.name}</button>`;
            select.innerHTML += `<option value="${cat.name}">${cat.name}</option>`;
            adminList.innerHTML += `
                <div style="display:flex; justify-content:space-between; background:#111; padding:10px; border-radius:5px; margin-bottom:5px">
                    <span>${cat.name}</span>
                    <i class="fas fa-trash" style="color:red; cursor:pointer" onclick="db.ref('categorias/${child.key}').remove()"></i>
                </div>`;
        });
    });

    // --- LÃ“GICA DE PRODUTOS ---
    function saveProduct() {
        const id = document.getElementById('edit-id').value;
        const data = {
            name: document.getElementById('p-name').value,
            price: document.getElementById('p-price').value,
            img: document.getElementById('p-img').value,
            cat: document.getElementById('p-cat').value
        };

        if(!data.name || !data.price) return toast("Preencha Nome e PreÃ§o!");

        if(id) {
            db.ref('produtos/' + id).update(data);
            toast("Produto Atualizado!");
        } else {
            db.ref('produtos').push(data);
            toast("Produto Criado!");
        }
        resetForm();
    }

    function deleteProduct(id) {
        if(confirm("Excluir este item?")) {
            db.ref('produtos/' + id).remove();
            toast("Item removido!");
        }
    }

    function editProduct(id, n, p, i, c) {
        document.getElementById('form-title').innerText = "Editar Produto";
        document.getElementById('edit-id').value = id;
        document.getElementById('p-name').value = n;
        document.getElementById('p-price').value = p;
        document.getElementById('p-img').value = i;
        document.getElementById('p-cat').value = c;
        document.getElementById('btn-save').innerText = "SALVAR ALTERAÃ‡Ã•ES";
        document.getElementById('btn-cancel').style.display = "block";
        window.scrollTo(0,0);
    }

    function resetForm() {
        document.getElementById('form-title').innerText = "Adicionar Produto";
        document.getElementById('edit-id').value = "";
        document.getElementById('p-name').value = "";
        document.getElementById('p-price').value = "";
        document.getElementById('p-img').value = "";
        document.getElementById('btn-save').innerText = "CADASTRAR";
        document.getElementById('btn-cancel').style.display = "none";
    }

    // --- RENDERIZAÃ‡ÃƒO ---
    function renderStore(filter) {
        db.ref('produtos').once('value', snap => {
            const storeGrid = document.getElementById('store-grid');
            const adminGrid = document.getElementById('admin-items-grid');
            storeGrid.innerHTML = "";
            adminGrid.innerHTML = "";

            snap.forEach(child => {
                const p = child.val();
                const id = child.key;

                if(filter === 'all' || p.cat === filter) {
                    storeGrid.innerHTML += `
                        <div class="card" data-aos="fade-up">
                            ${p.cat ? `<div class="cat-tag">${p.cat}</div>` : ''}
                            ${p.img ? `<img src="${p.img}">` : '<div class="no-img">ðŸ“¦</div>'}
                            <h3>${p.name}</h3>
                            <div style="color:var(--primary); font-weight:bold; margin: 15px 0">R$ ${p.price}</div>
                            <button class="btn btn-buy" onclick="toast('Adicionado ao carrinho!')">COMPRAR AGORA</button>
                        </div>`;
                }

                adminGrid.innerHTML += `
                    <div class="card" style="padding:15px; text-align:left; font-size:0.8rem">
                        <b>${p.name}</b><br>R$ ${p.price}<br>
                        <div style="display:flex; gap:5px; margin-top:10px">
                            <button class="btn" style="background:#f39c12; padding:5px 10px; font-size:0.6rem" onclick="editProduct('${id}','${p.name}','${p.price}','${p.img}','${p.cat}')">EDITAR</button>
                            <button class="btn" style="background:red; padding:5px 10px; font-size:0.6rem" onclick="deleteProduct('${id}')">EXCLUIR</button>
                        </div>
                    </div>`;
            });
        });
    }

    db.ref('produtos').on('value', () => renderStore('all'));

    function accessAdmin() {
        if(prompt("Chave Mestra:") === "270712") openTab('admin');
    }

    AOS.init();
</script>
</body>
</html>
