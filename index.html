<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>Loja</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>

<style>
body {
    margin: 0;
    font-family: Arial, sans-serif;
    background: #f5f5f5;
}
header {
    background: #000;
    color: #fff;
    padding: 15px;
    text-align: center;
}
main {
    padding: 20px;
}
.produto {
    background: #fff;
    padding: 15px;
    margin-bottom: 10px;
    border-radius: 5px;
}
footer {
    position: fixed;
    bottom: 0;
    width: 100%;
    background: #000;
    color: #fff;
    text-align: center;
    padding: 10px;
}
footer span {
    cursor: pointer;
    font-weight: bold;
}

/* MODAIS */
.modal {
    display: none;
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.6);
    justify-content: center;
    align-items: center;
}
.modal-content {
    background: #fff;
    padding: 20px;
    width: 300px;
    border-radius: 6px;
}
button {
    padding: 10px;
    margin-top: 10px;
    width: 100%;
}
input {
    width: 100%;
    padding: 8px;
    margin-top: 5px;
}
</style>
</head>
<body>

<header>
    <h1>Minha Loja</h1>
</header>

<main id="listaProdutos"></main>

<footer>
    <span onclick="abrirSenha()">BY LEAL</span>
</footer>

<!-- MODAL SENHA -->
<div class="modal" id="modalSenha">
    <div class="modal-content">
        <h3>Área restrita</h3>
        <input type="password" id="senhaAdm" placeholder="Senha">
        <button onclick="verificarSenha()">Entrar</button>
    </div>
</div>

<!-- MODAL ADMIN -->
<div class="modal" id="modalAdmin">
    <div class="modal-content">
        <h3>Área Admin</h3>
        <button onclick="loginGoogle()">Login com Google</button>
        <hr>
        <input id="nomeProduto" placeholder="Nome do produto">
        <input id="precoProduto" placeholder="Preço">
        <button onclick="cadastrarProduto()">Cadastrar Produto</button>
        <button onclick="fecharAdmin()">Sair</button>
    </div>
</div>

<script>
// FIREBASE
const firebaseConfig = {
    apiKey: "AIzaSyCYzx7TPmAghFcGuKYzBDIYRW0SjrMJ_r8",
    databaseURL: "https://quebrei-o-sistema-default-rtdb.firebaseio.com",
    projectId: "quebrei-o-sistema"
};
firebase.initializeApp(firebaseConfig);

const db = firebase.database();
const auth = firebase.auth();

// PRODUTOS
function carregarProdutos() {
    db.ref("produtos").on("value", snap => {
        const lista = document.getElementById("listaProdutos");
        lista.innerHTML = "";
        snap.forEach(item => {
            const p = item.val();
            lista.innerHTML += `
                <div class="produto">
                    <h3>${p.nome}</h3>
                    <p>R$ ${p.preco}</p>
                </div>
            `;
        });
    });
}
carregarProdutos();

// ADMIN
function abrirSenha() {
    document.getElementById("modalSenha").style.display = "flex";
}

function verificarSenha() {
    const senha = document.getElementById("senhaAdm").value;
    if (senha === "270712") {
        document.getElementById("modalSenha").style.display = "none";
        document.getElementById("modalAdmin").style.display = "flex";
    } else {
        alert("Senha incorreta");
    }
}

function fecharAdmin() {
    document.getElementById("modalAdmin").style.display = "none";
}

// GOOGLE LOGIN
function loginGoogle() {
    const provider = new firebase.auth.GoogleAuthProvider();
    auth.signInWithPopup(provider)
        .then(res => alert("Logado: " + res.user.displayName))
        .catch(err => alert(err.message));
}

// CADASTRO PRODUTO
function cadastrarProduto() {
    const nome = document.getElementById("nomeProduto").value;
    const preco = document.getElementById("precoProduto").value;

    db.ref("produtos").push({
        nome,
        preco
    });

    alert("Produto cadastrado");
}
</script>

</body>
</html>
