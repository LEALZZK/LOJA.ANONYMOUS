<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FiveM Store | Galactic Edition</title>
    
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-database-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-auth-compat.js"></script>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

    <style>
        :root { --primary: #00ff88; --secondary: #007bff; --bg: #050505; }
        
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', sans-serif; }

        body { 
            background: radial-gradient(circle at center, #110a1f 0%, #050505 100%) fixed;
            color: white; min-height: 100vh; overflow-x: hidden;
        }

        /* FUNDO DE ESTRELAS */
        .stars {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: url('https://www.transparenttextures.com/patterns/stardust.png');
            opacity: 0.3; z-index: -1; animation: move 120s linear infinite;
        }
        @keyframes move { from {background-position: 0 0;} to {background-position: 1000px 1000px;} }

        /* HEADER ESTILO FIVEM STORE (IGUAL IMAGEM) */
        header {
            background: #000; padding: 20px 8%;
            display: flex; justify-content: space-between; align-items: center;
            border-bottom: 1px solid #222; position: sticky; top: 0; z-index: 1000;
        }

        .brand { font-size: 1.4rem; letter-spacing: 1px; font-weight: 300; }
        .brand b { font-weight: 700; color: #fff; }

        .nav-menu { display: flex; gap: 30px; align-items: center; }
        .nav-menu a { 
            color: #999; text-decoration: none; font-size: 0.85rem; 
            text-transform: uppercase; font-weight: bold; cursor: pointer;
        }
        .nav-menu a:hover, .nav-menu a.active { color: #fff; }
        .search-icon { color: #fff; font-size: 1.1rem; cursor: pointer; margin-left: 10px; }

        /* BANNER DISCORD */
        .discord-banner {
            background: #5865F2; margin: 20px 8%; padding: 25px;
            border-radius: 5px; display: flex; align-items: center; gap: 20px;
        }
        .discord-banner i { font-size: 2.5rem; }
        .discord-info h3 { font-size: 1.5rem; }

        /* GRID DE PRODUTOS */
        .container { padding: 40px 8%; }
        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(240px, 1fr)); gap: 25px; }
        
        /* CARD SEM IMAGEM (ESTILO CAIXA) */
        .card { 
            background: rgba(255,255,255,0.03); border: 1px solid #222;
            padding: 20px; border-radius: 8px; text-align: center;
        }
        .card:hover { border-color: var(--secondary); background: rgba(255,255,255,0.05); }
        .card img { width: 100%; height: 160px; object-fit: contain; margin-bottom: 15px; }
        .product-box { 
            height: 160px; background: rgba(0,0,0,0.3); border: 1px dashed #444;
            display: flex; align-items: center; justify-content: center; 
            margin-bottom: 15px; border-radius: 5px; font-size: 3rem; opacity: 0.5;
        }

        /* LOGIN BUTTON */
        .btn-login {
            background: #db4437; color: white; border: none; padding: 10px 20px;
            border-radius: 4px; font-weight: bold; cursor: pointer; font-size: 0.8rem;
        }

        /* CHAT / FORUM */
        .forum-container { background: #0a0a0a; border: 1px solid #222; border-radius: 8px; height: 400px; display: flex; flex-direction: column; }
        .msg-list { flex: 1; padding: 20px; overflow-y: auto; }
        .msg-input { display: flex; padding: 15px; background: #000; border-top: 1px solid #222; gap: 10px; }
        input { flex: 1; background: #111; border: 1px solid #333; color: white; padding: 10px; border-radius: 4px; outline: none; }

        #notif { position: fixed; bottom: 20px; right: 20px; z-index: 2000; }
        .toast { background: var(--secondary); padding: 15px 25px; border-radius: 5px; margin-top: 10px; animation: slide 0.3s forwards; }
        @keyframes slide { from {transform: translateX(100%);} to {transform: translateX(0);} }
        
        section { display: none; }
        section.active { display: block; }
    </style>
</head>
<body>

<div class="stars"></div>
<div id="notif"></div>

<header>
    <div class="brand">FIVEM <b>STORE</b></div>
    <div class="nav-menu">
        <a onclick="showTab('loja')" id="t-loja" class="active">RecepÃ§Ã£o</a>
        <a onclick="showTab('forum')" id="t-forum">Comunidade</a>
        <a onclick="showTab('suporte')" id="t-suporte">Suporte</a>
        <div id="auth-ui">
            <button class="btn-login" onclick="login()">LOGIN GMAIL</button>
        </div>
        <i class="fas fa-search search-icon"></i>
    </div>
</header>

<div class="discord-banner">
    <i class="fab fa-discord"></i>
    <div class="discord-info">
        <h3>Discord</h3>
        <p>0 Members Online</p>
    </div>
</div>

<div class="container">
    <section id="loja" class="active">
        <div id="product-grid" class="grid"></div>
    </section>

    <section id="forum">
        <div class="forum-container">
            <div id="forum-msgs" class="msg-list"></div>
            <div class="msg-input">
                <input type="text" id="forum-in" placeholder="Diga algo...">
                <button onclick="sendChat()" class="btn-login" style="background:var(--secondary)">ENVIAR</button>
            </div>
        </div>
    </section>

    <section id="suporte">
        <div class="card" style="max-width: 500px; margin: auto;">
            <h3>Suporte TÃ©cnico</h3>
            <p style="color:#777; margin: 15px 0;">Abra um ticket para falar com a gerÃªncia.</p>
            <button onclick="toast('Ticket aberto! Aguarde contato.')" class="btn-login" style="width:100%; background:var(--primary); color:#000">ABRIR TICKET</button>
        </div>
    </section>
</div>

<footer style="padding:40px; text-align:center; opacity:0.1; cursor:pointer" onclick="goAdmin()">ADMIN</footer>

<script>
    // --- CONFIGURAÃ‡ÃƒO FIREBASE ---
    const firebaseConfig = {
        apiKey: "AIzaSyCYzx7TPmAghFcGuKYzBDIYRW0SjrMJ_r8",
        authDomain: "quebrei-o-sistema.firebaseapp.com",
        databaseURL: "https://quebrei-o-sistema-default-rtdb.firebaseio.com",
        projectId: "quebrei-o-sistema",
        appId: "1:133672006102:web:e62c681ced44b3650f7477"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();
    const auth = firebase.auth();
    let user = null;

    function toast(m) {
        const t = document.createElement('div'); t.className='toast'; t.innerText=m;
        document.getElementById('notif').appendChild(t);
        setTimeout(() => t.remove(), 3000);
    }

    function showTab(id) {
        document.querySelectorAll('section').forEach(s => s.classList.remove('active'));
        document.querySelectorAll('.nav-menu a').forEach(a => a.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        document.getElementById('t-'+id).classList.add('active');
    }

    // --- LOGIN CORRIGIDO ---
    function login() {
        const provider = new firebase.auth.GoogleAuthProvider();
        // Usamos signInWithRedirect se o popup falhar, mas o Popup Ã© melhor:
        auth.signInWithPopup(provider).then(res => {
            user = res.user;
            document.getElementById('auth-ui').innerHTML = `<img src="${user.photoURL}" style="width:30px; border-radius:50%; border:2px solid var(--primary)">`;
            toast("Bem-vindo!");
        }).catch(e => {
            console.log(e);
            alert("ERRO: VÃ¡ no Console Firebase > Authentication > Settings e adicione este domÃ­nio em 'Authorized Domains'");
        });
    }

    // --- CARREGAR PRODUTOS (ADAPTÃVEL) ---
    db.ref('produtos').on('value', snap => {
        const grid = document.getElementById('product-grid');
        grid.innerHTML = "";
        snap.forEach(child => {
            const p = child.val();
            grid.innerHTML += `
                <div class="card">
                    ${p.img ? `<img src="${p.img}">` : '<div class="product-box">ðŸ“¦</div>'}
                    <h4 style="margin-bottom:10px">${p.name}</h4>
                    <p style="color:var(--primary); font-weight:bold; margin-bottom:15px">R$ ${p.price}</p>
                    <button class="btn-login" style="width:100%; background:var(--secondary)" onclick="toast('Adicionado!')">COMPRAR</button>
                </div>`;
        });
    });

    // --- CHAT ---
    function sendChat() {
        if(!user) return toast("FaÃ§a login!");
        const txt = document.getElementById('forum-in').value;
        if(txt) {
            db.ref('forum').push({ name: user.displayName, text: txt });
            document.getElementById('forum-in').value = "";
        }
    }

    db.ref('forum').limitToLast(15).on('value', snap => {
        const box = document.getElementById('forum-msgs');
        box.innerHTML = "";
        snap.forEach(child => {
            const m = child.val();
            box.innerHTML += `<div style="margin-bottom:10px"><b>${m.name}:</b> ${m.text}</div>`;
        });
        box.scrollTop = box.scrollHeight;
    });

    function goAdmin() {
        if(prompt("Senha:") === "270712") {
            const n = prompt("Nome produto:");
            const p = prompt("PreÃ§o:");
            const i = prompt("Link imagem (vazio p/ sem imagem):");
            if(n) db.ref('produtos').push({name: n, price: p, img: i});
        }
    }
</script>
</body>
</html>
